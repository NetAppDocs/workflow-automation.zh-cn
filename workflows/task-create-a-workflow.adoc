---
permalink: workflows/task-create-a-workflow.html 
sidebar: sidebar 
keywords: use, workflow, automation, create, tasks, provisioning, migrate, decommissioning, storage, databases, file, systems, predefined, wfa, match, requirements 
summary: 您可以使用 Workflow Automation （ WFA ）为数据库或文件系统的配置，迁移和停用存储等任务创建工作流。如果预定义的 WFA 工作流不符合您的要求，则应创建工作流。 
---
= 创建工作流
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以使用 Workflow Automation （ WFA ）为数据库或文件系统的配置，迁移和停用存储等任务创建工作流。如果预定义的 WFA 工作流不符合您的要求，则应创建工作流。

.您需要的内容
* 您必须已了解 WFA 组件的概念。
* 您必须已了解工作流所需的功能，例如重复行，批准点和资源选择。
* 您必须已完成工作流所需的规划，包括工作流要求检查清单。
* 您应已创建帮助内容，该内容可向存储操作员提供有关工作流的信息。


.关于此任务
根据工作流的目标和要求，每个工作流的构造可能会有所不同。此任务不提供特定工作流的说明，而是提供创建工作流的一般说明。

.步骤
. 单击 * 工作流设计 * > * 工作流 * 。
. 单击 image:../media/new_wfa_icon.gif["新建图标"] 在工具栏上。
. 在 * 工作流 * 选项卡中，执行以下步骤：
+
.. 展开所需的架构，然后双击所需的 image:../media/wfa_command_icon.gif["命令图标"] （命令）或 image:../media/wfa_workflow_icon.gif["工作流图标"] （工作流）。
+
您可以根据需要重复此步骤。您可以通过拖放步骤在工作流编辑器中重新排列这些步骤。

.. * 可选： * 单击 image:../media/add_row2_wfa_icon.gif[""] 添加所需的行数，这些行用于指定执行步骤的详细信息。
+
每个步骤都会根据指定行和列中的指定步骤详细信息执行。这些步骤会按从左到右以及从上到下的顺序执行。

.. 将光标置于已添加的步骤下方，然后单击 image:../media/add_object_wfa_icon.gif["命令详细信息图标"] 要为步骤执行添加步骤详细信息，请在所需行处添加。
+
[cols="2*"]
|===
| 此步骤 | 执行此操作 ... 


 a| 
工作流
 a| 
在 * 工作流 * 选项卡中输入所需的用户输入，并在 * 高级 * 选项卡中输入所需的条件。



 a| 
命令
 a| 
在 <command> 的参数选项卡中，单击每个对象选项卡，选择所需选项以定义对象属性，然后在高级选项卡和其他参数选项卡中输入所需的详细信息。



 a| 
搜索或定义
 a| 
选择应搜索或定义的词典条目对象。

|===
+
下图显示了用于定义对象属性的可用选项：

+
image::../media/define_object_options.gif[定义对象选项]

+
选择相应的操作：

+
[cols="2*"]
|===
| 针对 ... | 执行此操作 ... 


 a| 
填充属性
 a| 
使用以下选项输入属性值：

*** 表达式
*** 变量
*** 用户输入
*** 资源选择
*** 增量命名


您必须将光标置于属性字段上方，然后单击 image:../media/elipsisicon.gif[""] 可使用资源选择或增量命名功能。



 a| 
使用先前定义的 ` 对象 _`
 a| 
在选项列表前面的框中选择先前定义的 `对象` 。



 a| 
通过搜索现有的 ` object_s_`
 a| 
... 单击 * 输入搜索条件 * 以使用资源选择功能搜索对象。
... 如果未找到所需的对象，请选择一个所需的执行选项：
+
**** 中止工作流
+
如果未找到特定对象，此选项将中止工作流执行。

**** 禁用此命令
+
 This option disables only the current step and executes the workflow.
**** 填写 `object` 的属性并执行命令
+
 This option enables you to enter the required attributes and execute the workflow.




|===


. 如果要插入批准点，请单击 image:../media/approval_point_hover_icon.gif["批准点悬停图标"] 并输入批准点所需的注释。
+
批准点注释可以包括 MVEL 表达式。

. 单击 image:../media/repeat_row_arrow.gif[""] 位于行号旁边，用于执行以下操作：
+
** 插入一行。
** 复制此行。
** 重复此行。
+
您可以使用以下选项之一指定命令参数的重复：

+
*** 次数
+
您可以使用此选项对指定的重复次数重复执行命令。例如，您可以指定应重复执行 "`Create qtree` " 命令三次，以创建三个 qtree 。

+
您也可以使用此选项执行动态数量的命令。例如，您可以为要创建的 LUN 数量创建一个用户输入变量，并在执行或计划工作流时使用存储操作员指定的编号。

*** 组中的每个资源
+
您可以使用此选项，然后指定对象的搜索条件。此命令的重复次数与搜索条件返回的对象相同。例如，您可以搜索集群中的节点，然后对每个节点重复 "`Create iSCSI Logical Interface` " 命令。



** 添加行执行条件。
** 删除行。


. 在 * 详细信息 * 选项卡中，执行以下步骤：
+
.. 在 * 工作流名称 * 和 * 工作流问题描述 * 字段中指定所需信息。
+
每个工作流的工作流名称和问题描述 必须是唯一的。

.. * 可选： * 指定实体版本。
.. * 可选： * 如果不想使用预留功能，请清除 * 考虑预留元素 * 复选框。
.. * 可选： * 如果不希望对同名元素启用验证，请清除 * 启用元素存在验证 * 复选框。


. 如果要编辑用户输入，请执行以下步骤：
+
.. 单击 * 用户输入 * 选项卡。
.. 双击要编辑的用户输入。
.. 在 * 编辑变量： < 用户输入 >* 对话框中，编辑用户输入。


. 如果要添加常量，请执行以下步骤
+
.. 单击 * 常量 * 选项卡，然后使用 * 添加 * 按钮为工作流添加所需的常量。
+
如果使用通用值定义多个命令的参数，则可以定义常量。例如，请参见 "`使用 SnapVault` 创建，映射和保护 LUN " 工作流中使用的 aggregate_overcommit_threshold 常量。

.. 输入每个常量的名称，问题描述 和值。


. 单击 * 返回参数 * 选项卡，然后使用 * 添加 * 按钮为您的工作流添加所需的参数。
+
如果工作流规划和执行在规划期间必须返回一些计算值或选定值，则可以使用返回参数。您可以在工作流预览中或工作流执行完成后，在监控窗口的返回参数选项卡中查看计算值或选定值。

+
聚合：您可以将聚合指定为返回参数，以查看使用资源选择逻辑选择的聚合。

+
如果工作流中包含子工作流，并且子工作流返回参数名称包含空格，美元符号（ $ ）， 或者函数，您应在父工作流中指定方括号内的返回参数名称，以查看父工作流中的子工作流返回参数值。

+
[cols="2*"]
|===
| 参数名称 | 指定为 ... 


 a| 
`子工作流 1.abc$value`
 a| 
`子工作流 1["abc$++" 值 "]`



 a| 
`子工作流 1.$value`
 a| 
`子工作流 1="$++" 值 "]`



 a| 
`子工作流 1.value$`
 a| 
`子工作流 1.value$`



 a| 
`子工作流 1.P N`
 a| 
`子工作流 1["P N"]`



 a| 
`子工作流 1.return_string （ "hw" ）`
 a| 
`子工作流 1["return_string （ "hw\" ） "]`

|===
. * 可选： * 单击 * 帮助内容 * 选项卡以添加为工作流创建的帮助内容文件。
. 单击 * 预览 * 并确保已成功完成工作流规划。
. 单击 * 确定 * 以关闭预览窗口。
. 单击 * 保存 * 。




== 完成后

在测试环境中测试工作流，然后在 * ； WorkflowName_* > * ； _Details_* 中将此工作流标记为已准备好投入生产。
